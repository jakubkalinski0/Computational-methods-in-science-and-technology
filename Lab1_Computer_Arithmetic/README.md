# Lab 1: Computer Arithmetic - Numerical Stability Analysis

## Overview

This project investigates the effects of floating-point precision and different calculation methods on numerical stability when evaluating a specific polynomial near a root. The polynomial is mathematically equivalent to $f(x) = (x - 1)^8$. Calculations are performed for $x$ values within the range $[0.99, 1.01]$, where $x=1$ is a root, making this region sensitive to numerical errors, especially subtractive cancellation.

The project implements and compares four different methods for calculating the function's value using `float`, `double`, and `long double` precision. The goal is to observe and explain the differences in the results obtained, highlighting concepts like numerical stability, subtractive cancellation, and the limitations of floating-point arithmetic.

## Problem Description (Original Polish Task)

WykonaÄ‡ obliczenia (dla zmiennych typu float, double, long double) wg podanych poniÅ¼ej wzorÃ³w dla 101 rÃ³wnoodlegÅ‚ych wartoÅ›ci $x$ z przedziaÅ‚u $[0.99, 1.01]$:

*   $f(x) = x^8 - 8x^7 + 28x^6 - 56x^5 + 70x^4 - 56x^3 + 28x^2 - 8x + 1$
*   $f(x) = (((((((x - 8)x + 28)x - 56)x + 70)x - 56)x + 28)x - 8)x + 1$
*   $f(x) = (x - 1)^8$
*   $f(x) = \exp(8 \ln |x-1|)$ , dla $x \neq 1$

PorÃ³wnaÄ‡ wyniki. ObjaÅ›niÄ‡ rÃ³Å¼nice w wynikach.

*(**Translation:** Perform calculations (for variables of type float, double, long double) according to the formulas below for 101 equidistant values of $x$ from the interval $[0.99, 1.01]$: [formulas listed]. Compare the results. Explain the differences in the results.)*


## Calculation Methods Implemented

The project implements and compares the following methods based on the problem description:

1.  **Direct Polynomial Expansion:**
    $f(x) = x^8 â€“ 8x^7 + 28x^6 â€“ 56x^5 + 70x^4 â€“ 56x^3 + 28x^2 â€“ 8x + 1$
    (Implemented in `function1_*`)
2.  **Horner's Method:** A nested multiplication scheme, often more stable and efficient for polynomial evaluation.
    $f(x) = (((((((x âˆ’ 8)x + 28)x âˆ’ 56)x + 70)x âˆ’ 56)x + 28)x âˆ’ 8)x + 1$
    (Implemented in `function2_*`)
3.  **Direct Power Calculation:** The most direct form.
    $f(x) = (x âˆ’ 1)^8$
    (Implemented in `function3_*`)
4.  **Exponential/Logarithmic Form:** Mathematically equivalent for $x \neq 1$, but introduces potential issues from `log` and `exp` functions, especially near the singularity.
    $f(x) = \exp(8 \ln(|xâˆ’1|))$ for $x \neq 1$
    (Implemented in `function4_*`)

Each method is implemented using three standard C floating-point types: `float`, `double`, and `long double`.

## Features

*   Calculates function values using 4 different mathematical formulations.
*   Uses `float`, `double`, and `long double` precision for comparison.
*   Generates 101 data points in the sensitive range $[0.99, 1.01]$.
*   Saves computed results to CSV files in multiple formats (combined and separate).
*   Performs relative error analysis comparing `float` and `double` results against `long double` as a reference.
*   Automatically generates Gnuplot scripts (`.gp`) for visualizing:
    *   Comparison of precisions for each function.
    *   Comparison of functions for each precision (original format).
    *   Overall relative error analysis.
    *   Individual plots for each function/precision combination.
    *   A collage multiplot comparing all results.
*   Provides Makefile targets for easy compilation, execution, plotting, and cleanup.

## ğŸ“ Project Structure
- ğŸ“ **Lab1_Computer_Arithmetic/** â€“ Main
    - ğŸ“ **include/** â€“ Header files (.h)
        - ğŸ“„ `functions.h`
        - ğŸ“„ `utilities.h`
    - ğŸ“ **src/** â€“ Source code files (.c)
        - ğŸ“„ `functions.c`
        - ğŸ“„ `main.c`
        - ğŸ“„ `utilities.c`
    - ğŸ“ **bin/** â€“ Compiled executable (created by `make`)
    - ğŸ“ **obj/** â€“ Object files (.o) (created by `make`)
    - ğŸ“ **data/** â€“ Output CSV data files (created by `make run` / `make plots`)
    - ğŸ“ **scripts/** â€“ Gnuplot scripts (.gp) generated by `make run` / `make plots`
    - ğŸ“ **plots/** â€“ Plot images (.png) generated by `make plots`
    - ğŸ› ï¸ **Makefile** â€“ Build script
    - ğŸ“˜ **README.md** â€“ Project description (this file)
    - ğŸ“„ **Report_Lab1_Computer_Arithmetic.pdf** â€“ Detailed analysis (in Polish)


## Requirements

*   **C Compiler:** A C compiler supporting the C11 standard (e.g., GCC).
*   **Make:** The `make` build automation tool.
*   **Gnuplot:** The Gnuplot utility for generating plots from the scripts.

## Building and Running

The project uses a Makefile for easy management. Open your terminal in the project's root directory.

1.  **Compile:**
    ```bash
    make all
    # or simply:
    make
    ```
    This compiles the source code and creates the executable `bin/computer_arithmetic`.

2.  **Run the C program (Generate Data & Scripts):**
    ```bash
    make run
    ```
    This will first compile the code (if needed) and then execute the C program. The Makefile automatically provides the necessary directory paths (`data`, `scripts`, `plots`) to the executable. This step generates:
    *   CSV data files in the `data/` directory.
    *   Gnuplot `.gp` script files in the `scripts/` directory.

3.  **Generate Plots:**
    ```bash
    make plots
    ```
    This performs the `make run` steps (compiling and running the C code to generate data/scripts) and *then* automatically executes all the generated Gnuplot scripts (`*.gp`) found in the `scripts/` directory. This step generates:
    *   PNG plot images in the `plots/` directory.

4.  **Display Help:**
    ```bash
    make help
    ```
    Shows a summary of available Makefile commands.

## Output Files

After running `make plots`, you will find the following generated files:

*   **`data/` Directory:**
    *   `results.csv`: Combined results for all functions and precisions in a wide format.
    *   `separate_results_f[1-4].csv`: Individual results for each function (columns: $x$, float, double, long_double).
    *   `separate_results_error_analysis.csv`: Relative errors of `float` and `double` results compared to `long double`.
*   **`scripts/` Directory:**
    *   Multiple `.gp` files. These are Gnuplot scripts configured to read data from `data/` and generate plots in `plots/`.
*   **`plots/` Directory:**
    *   Multiple `.png` files. These are the graphical plots visualizing the results and errors, generated by Gnuplot via the `make plots` command. Examine these plots to understand the numerical behavior.

## Analysis and Interpretation

A detailed analysis of the results, explaining the observed differences due to floating-point precision, calculation methods, and numerical stability issues (like subtractive cancellation), can be found in the accompanying report file:

**`Report_Lab1_Computer_Arithmetic.pdf`**

Please note that the analysis within that document is written in **Polish**.

## Cleanup

*   **Remove generated files (but keep directories):**
    ```bash
    make clean
    ```
    This removes object files (`*.o`), the executable, CSV files (`*.csv`), Gnuplot scripts (`*.gp`), and plot images (`*.png`).

*   **Remove generated files AND directories:**
    ```bash
    make distclean
    ```
    This does everything `make clean` does and also removes the `obj/`, `bin/`, `data/`, `scripts/`, and `plots/` directories.